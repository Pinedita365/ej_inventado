<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TriPing - Actividades del viaje</title>
    <link rel="stylesheet" href="css/styleActividades.css">
</head>

<body>

    <!-- HEADER -->
    <header class="header">
        <div class="header-left">
            <form th:action="@{/logout}" method="post" style="display: inline;">
                <button type="submit" th:text="#{nav.logout}" class="btn-logout">
                    Cerrar Sesi√≥n
                </button>
            </form>
        </div>
        <div class="header-center">
            <h1>TriPing</h1>
        </div>
        <div class="header-right">
            <span class="usuario" th:text="${session.nombre}">Nombre</span>
        </div>
    </header>

    <section class="imagen-entrada"></section>

    <section class="info-viaje">
        <div class="datos-viaje">
            <div class="fechas">
                <span
                    th:text="#{generico.desde} + ' ' + ${session.fEntrada} + ' ' + #{generico.al} + ' ' + ${session.fSalida}"></span>
            </div>
            <div class="localidad">
                <span th:text="#{generico.ciudad} + ': ' + ${session.ciudad}">Madrid</span>
            </div>
        </div>

        <div class="controles">
            <form action="" method="get">
                <label for="ordenar">Ordenar por:</label>
                <select id="ordenar" name="orden">
                    <option value="defecto" th:selected="${session.orden == 'defecto'}">Por defecto</option>
                    <option value="precio" th:selected="${session.orden == 'precio'}">Precio</option>
                </select>
                <input type="submit" value="Ordenar">
            </form>

            <div class="contador">
                Actividades a√±adidas: <span th:text="${session.cont}">0</span>
            </div>
        </div>
    </section>

    <section class="tipo-actividad">
        <h2 th:text="#{inicio.titulo_seccion(${session.ciudad})}"></h2>
        <div class="opciones-actividad">
            <form action="" method="get">
                <input type="hidden" name="tipo" value="DEPORTIVA">
                <input class="button" type="submit" value="Deportiva">
            </form>
            <form action="" method="get">
                <input type="hidden" name="tipo" value="GASTRONOMICA">
                <input class="button" type="submit" value="Gastron√≥mica">
            </form>
            <form action="" method="get">
                <input type="hidden" name="tipo" value="TURISTICA">
                <input class="button" type="submit" value="Tur√≠stica">
            </form>
            <form action="" method="get">
                <input type="hidden" name="tipo" value="all">
                <input class="button" type="submit" value="Todas las actividades">
            </form>
        </div>
    </section>

    <div class="contenedor-principal">

        <section class="contenedor-actividades">
            <div th:each="act : ${listaAct}"
                th:class="${session.tipo == null or session.tipo == 'all' or act.tipo.name() == session.tipo} ? 'card-actividad' : 'oculto'">

                <img th:src="@{${act.img}}" alt="Imagen de la actividad">
                <h3 th:text="${act.nombre}">Nombre Actividad</h3>
                <p th:text="${act.getBreveDesc()}">Descripci√≥n breve</p>
                <p><strong>Ciudad:</strong> <span th:text="${act.ciudad}">Ciudad</span></p>

                <div class="botones-card">
                    <form th:action="@{/verMas}" method="get">
                        <input type="hidden" name="id" th:value="${act.id}">
                        <input class="btn-detalles" type="submit" th:value="#{inicio.btn_ver}">
                    </form>
                    <form th:action="@{/inicio}" method="get">
                        <input type="hidden" name="a√±adirCarrito" th:value="${act.id}">
                        <input class="btn-anadir" type="submit" th:value="#{inicio.btn_a√±adir}">
                    </form>
                </div>
            </div>
        </section>

        <aside class="carrito">
            <h2>üõí CarriPing üó∫Ô∏è</h2>
            <hr>

            <div th:if="${session.carrito == null or session.carrito.isEmpty()}">
                <p th:text="#{inicio.carrito_vacio}"></p>
            </div>

            <ul th:if="${session.carrito != null and !session.carrito.isEmpty()}">
                <li th:each="act : ${session.carrito}">
                    <span th:text="${act.nombre}">Actividad</span>
                    <form th:action="@{/eliminarCarrito}" method="get" style="display:inline;">
                        <input type="hidden" name="idEliminar" th:value="${act.id}">
                        <input type="submit" class="btn-quitar" value="‚ùå">
                    </form>
                </li>
            </ul>

            <div class="precio-carrito">
                <strong th:text="#{inicio.carrito_total} + ': ' + ${session.precioCarro} + '‚Ç¨'"></strong>
            </div>

            <div class="carrito-acciones" th:if="${session.carrito != null and !session.carrito.isEmpty()}">
                <form th:action="@{/confirmarCarrito}" method="get">
                    <button type="submit" class="btn-confirmar" th:text="#{inicio.btn_confirmar}"></button>
                </form>
            </div>
        </aside>

    </div>
    <div th:if="${#authorization.expression('hasRole(''ROLE_ADMIN'')')}">
        <a th:href="@{/admin/panel}" class="btn-admin">‚öôÔ∏è Ir al Panel de Control</a>
    </div>

    <footer class="footer">
        <p>
            &copy; 2026 <span th:text="#{app.name}">TriPing</span> ‚Äî <span th:text="#{index.eslogan}">Tu planificador de
                viajes</span>
        </p>
        <div class="language-picker">
            <a href="?lang=es">ES üá™üá∏</a> |
            <a href="?lang=en">EN üá¨üáß</a>
        </div>
    </footer>

</body>

</html>